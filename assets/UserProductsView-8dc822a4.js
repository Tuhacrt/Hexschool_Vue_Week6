import{e as I,t as V,f as x,M as E,o as l,c as _,a as t,g as r,u as i,h as S,v as P,i as R,j as U,r as L,F as w,k as D,l as b,b as C,m as $,n as B,p as M,d as T,q as N}from"./index-a56c1b4c.js";import{_ as A}from"./PaginationComponent-a5b05979.js";const q={class:"modal-dialog modal-xl",role:"document"},F={class:"modal-content border-0"},H={class:"modal-header bg-dark text-white"},O={class:"modal-title",id:"findMoreModalLabel"},j={class:"modal-body"},z={class:"row"},K={class:"col-sm-6"},W=["src"],X={class:"col-sm-6"},G={class:"badge bg-primary rounded-pill"},J={key:0,class:"h5"},Q={key:1},Y={class:"h6"},Z={class:"h5"},tt={class:"input-group"},et={__name:"FindMoreModal",props:["tempProduct","addToCart"],setup(v,{expose:g}){const m=v,s=I();let d=null;const a=V(m,"tempProduct");let u=1;const f=()=>{u=1,d==null||d.show()},y=()=>d==null?void 0:d.hide();return x(()=>{d=new E(s.value,{keyboard:!1,backdrop:!1})}),g({showModal:f,hideModal:y}),(c,n)=>(l(),_("div",{id:"findMoreModal",ref_key:"findMoreModalRef",ref:s,class:"modal fade",tabindex:"-1",role:"dialog","aria-labelledby":"findMoreModalLabel","aria-hidden":"true"},[t("div",q,[t("div",F,[t("div",H,[t("h5",O,[t("span",null,r(i(a).title),1)]),t("button",{type:"button",class:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close",onClick:y})]),t("div",j,[t("div",z,[t("div",K,[t("img",{class:"img-fluid",src:i(a).imagesUrl,alt:""},null,8,W)]),t("div",X,[t("span",G,r(i(a).category),1),t("p",null,"商品描述："+r(i(a).description),1),t("p",null,"商品內容："+r(i(a).content),1),i(a).price<i(a).origin_price?(l(),_("div",J,r(i(a).origin_price)+" 元 ",1)):(l(),_("div",Q,[t("del",Y,"原價 "+r(i(a).origin_price)+" 元",1),t("div",Z,"現在只要 "+r(i(a).price)+" 元",1)])),t("div",null,[t("div",tt,[S(t("input",{min:"1",type:"number",class:"form-control","onUpdate:modelValue":n[0]||(n[0]=o=>R(u)?u.value=o:u=o)},null,512),[[P,i(u),void 0,{number:!0}]]),t("button",{type:"button",class:"btn btn-primary",onClick:n[1]||(n[1]=o=>v.addToCart(i(a).id,i(u)))}," 加入購物車 ")])])])])])])])],512))}},st={class:"container"},ot={class:"mt-4"},at={class:"table align-middle"},nt=t("thead",null,[t("tr",null,[t("th",null,"圖片"),t("th",null,"商品名稱"),t("th",null,"價格"),t("th")])],-1),it={key:0},lt={style:{width:"200px"}},dt={key:0},ct={class:"h6"},rt={class:"h5"},_t={key:1,class:"h5"},ut={class:"btn-group btn-group-sm"},pt=["onClick","disabled"],gt=["onClick","disabled"],mt=["onClick","disabled"],ht={class:"d-flex justify-content-center"},vt={__name:"UserProductsView",setup(v){const{VITE_URL:g,VITE_PATH:m}={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"tuhacrt",VITE_TOKEN:"loginToken",VITE_TEXT:"Environment is in production build",BASE_URL:"/Hexschool_Vue_Week6/",MODE:"production",DEV:!1,PROD:!0},s=U({loadingStatus:{loadingItem:""},products:[],tempProduct:{imagesUrl:[]},pagination:{}}),d=I(),a=async(c=s.pagination.current_page||1)=>{const n=`${g}/api/${m}/products?page=${c}`;try{const o=await $.get(n);s.products=o.data.products,s.pagination=o.data.pagination}catch(o){alert(o.response.data.message)}},u=async(c,n=1)=>{var e,h;const o=`${g}/api/${m}/cart`,p={product_id:c,qty:n};s.loadingStatus.loadingItem=c;try{const k=await $.post(o,{data:p});alert(k.data.message),s.loadingStatus.loadingItem="",(e=d.value)==null||e.hideModal()}catch(k){alert((h=k.response)==null?void 0:h.data.message)}};x(()=>{a()});const f=(c,n)=>{var o;switch(c){case"findMore":s.tempProduct={...n},(o=d.value)==null||o.showModal();break}},y=async c=>{const{id:n}=c,o=`${g}/api/${m}/product/${n}`;s.tempProduct={...c};try{await $.get(o),N.push(`/product/${n}`)}catch(p){alert(p.response.data.message)}};return(c,n)=>{var p;const o=L("font-awesome-icon");return l(),_(w,null,[t("div",st,[t("div",ot,[t("table",at,[nt,(p=s.products)!=null&&p.length?(l(),_("tbody",it,[(l(!0),_(w,null,D(s==null?void 0:s.products,e=>(l(),_("tr",{key:e.id},[t("td",lt,[e.imagesUrl?(l(),_("div",{key:0,style:B([{height:"100px","background-size":"cover","background-position":"center"},{backgroundImage:`url(${e==null?void 0:e.imagesUrl[0]})`}])},null,4)):b("",!0)]),t("td",null,r(e.title),1),t("td",null,[e.price<e.origin_price?(l(),_("div",dt,[t("del",ct,"原價 "+r(e.origin_price)+" 元",1),t("div",rt,"現在只要 "+r(e.price)+" 元",1)])):(l(),_("div",_t,r(e.origin_price)+" 元",1))]),t("td",null,[t("div",ut,[t("button",{type:"button",class:"btn btn-outline-secondary",onClick:h=>y(e),disabled:s.loadingStatus.loadingItem===e.id||!e.is_enabled},[s.loadingStatus.loadingItem===e.id?(l(),M(o,{key:0,icon:"spinner",pulse:""})):b("",!0),T(" 詳細希望 ")],8,pt),t("button",{type:"button",class:"btn btn-outline-secondary",onClick:h=>f("findMore",e),disabled:s.loadingStatus.loadingItem===e.id||!e.is_enabled},[s.loadingStatus.loadingItem===e.id?(l(),M(o,{key:0,icon:"spinner",pulse:""})):b("",!0),T(" 查看更多 ")],8,gt),t("button",{type:"button",class:"btn btn-outline-danger",onClick:h=>u(e.id),disabled:s.loadingStatus.loadingItem===e.id||!e.is_enabled},[s.loadingStatus.loadingItem===e.id?(l(),M(o,{key:0,icon:"spinner",pulse:""})):b("",!0),T(" 加到購物車 ")],8,mt)])])]))),128))])):b("",!0)])]),t("div",ht,[C(A,{pagination:s.pagination,onChangePage:a,ref:"paginationComponentRef"},null,8,["pagination"])])]),C(et,{"temp-product":s.tempProduct,"add-to-cart":u,ref_key:"findMoreModalRef",ref:d},null,8,["temp-product"])],64)}}};export{vt as default};
